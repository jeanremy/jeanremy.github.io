<!DOCTYPE html>
<html lang="fr-FR">
  <head>
    <meta charset="utf-8">
    
      <title>Installer Pi-Hole sur un Raspberry Pi et une box SFR - Jean-Rémy Praud</title>
    
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="description" content="Developpeur fullstack, j’aime travailler sur des projets porteurs de sens. Je m’intéresse tout particulièrement à l’éco-conception et à l’accessibilité.">
    <meta name="robots" content="noodp">

    
<link rel="icon" href="/favicon.ico">
<link rel="icon" type="image/svg+xml" href="/favicon.svg">
<link rel="apple-touch-icon" href="/apple-touch-icon.png">
    

    <meta property="og:title" content="Installer Pi-Hole sur un Raspberry Pi et une box SFR">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://jeanremypraud.com/notes/pi-hole-box-sfr/">
    <meta property="og:site_name" content="Jean-Rémy Praud">
    <meta property="og:description" content="Une introduction à l’installation d’un bloqueur de pub centralisé, disponible pour tous les clients d’un réseau">
    <meta property="og:image" content="/assets/og-images/3ef078d6.png">

    <link rel="stylesheet" href="/assets/css/base.css">
    
    <script type="application/ld+json">
	{
		"@context": "https://schema.org",
		"@graph": [
			{
				"@type": "WebSite",
				"@id": "https://jeanremypraud.com#website",
				"url": "https://jeanremypraud.com",
				"name": "Jean-Rémy Praud",
				"description": "Developpeur fullstack, j’aime travailler sur des projets porteurs de sens. Je m’intéresse tout particulièrement à l’éco-conception et à l’accessibilité.",
				"inLanguage": "fr_FR"
			}
		]
	}
</script>

  </head>
  <body class="page">
    
    <a href="#main" class="sr-only sr-only-focusable">Accéder au contenu</a>

    <header class="page-header" role="banner">
  <div class="container">
    <p class="page__title">
      <a href="/" rel="me" title="jr retour à l'accueil">jr<span>.</span></a>
    </p>
    <nav class="page-header__menu" role="navigation" aria-label="Navigation principale">
      <ul>
        <li>
          <a href="/notes/" aria-current="page">Notes</a>
        </li>
        <li>
          <a href="/a-propos/">À propos</a>
        </li>
      </ul>
      
    </nav>
  </div>
</header>


    <main class="main" role="main" id="main" tabindex="-1">
      <article class="article">
  <header class="article__header">
    <div class="container">
      
        


  <nav class="breadcrumb" role="navigation" aria-label="Fil d'ariane">
    
      
        <a href="/">Accueil</a> >
      
    
      
        <a href="/notes/">Notes</a> >
      
    
      
        Installer Pi-Hole sur un Raspberry Pi et une box SFR
      
    
  </nav>


      

      <h1 class="article__title">
        Installer Pi-Hole sur un Raspberry Pi et une box SFR
      </h1>
    </div>
  </header>
  <section class="article__content">
    <div class="container">
      
        <p class="article__date">
        Posté le
          <time datetime="2022-11-13">13/11/2022</time>
        </p>
      
      
      <div class="md blog_content">
        <p>En quelques minutes, il est possible d'installer chez soi un bloqueur de pubs avec <a href="https://pi-hole.net/">Pi-Hole</a>.</p>
<p>Pour cela, j'ai utilisé:</p>
<ul>
<li>Un Raspberry Pi (mobèle 3B)</li>
<li>Un câble Ethernet pour le relier à la box</li>
<li>Une carte micro SD de 16 Go</li>
</ul>
<h2 id="fonctionnement" tabindex="-1">Fonctionnement <a class="title-anchor" href="#fonctionnement" aria-hidden="true">#</a></h2>
<p>Sur le réseau local, Pi-Hole agit comme serveur DNS disposant d'une liste de domaines indésirables. Lorsqu'une requête pointe vers un de ces domaines, le serveur répond par une page vierge. Contrairement aux bloqueurs de pub qui s'installent dans les navigateurs de chaque périphérique, Pi-Hole s'éxécute sur le réseau, et bénéficie donc à tous les périphériques connectés.</p>
<h2 id="installer-raspberry-pi-os" tabindex="-1">Installer Raspberry Pi OS <a class="title-anchor" href="#installer-raspberry-pi-os" aria-hidden="true">#</a></h2>
<p>Si ce n'est déjà fait, il faut installer un OS sur la carte SD afin que le Raspberry Pi puisse fonctionner. e processus s'est grandement amélioré avec le sortie de <a href="https://www.raspberrypi.com/software/#:~:text=Raspberry%20Pi%20Imager">Raspberry Pi Imager</a>. Il suffit de télécharger le logiciel, puis de se laisser guider.
Il suffit de choisir l'OS et de sélectionner quelques options, comme l'activation de SSH, l'activation du wifi, etc.</p>
<p><img loading="lazy" decoding="async" src="/notes/pi-hole-box-sfr/IxRdNIORFi-320.webp" alt="" width="640" height="419" srcset="/notes/pi-hole-box-sfr/IxRdNIORFi-320.webp 320w, /notes/pi-hole-box-sfr/IxRdNIORFi-640.webp 640w" sizes="(max-width: 640px) 320px, 640px"></p>
<h2 id="configuration-reseau" tabindex="-1">Configuration réseau <a class="title-anchor" href="#configuration-reseau" aria-hidden="true">#</a></h2>
<p>Pour que Pi-Hole puisse fonctionner, il faut attribuer au Raspberry Pi un IP locale statique dans l'interface d'administration de la box, accessible à l'adresse <a href="http://192.168.1.1/">http://192.168.1.1/</a>.
Le mot de passe par défaut varie en fonction des modèles. Une liste complète est disponible <a href="https://actuneuf.com/tutoriel/interface-box-sfr">ici</a>.</p>
<p>Pour ajouter une IP statique, il faut se rendre dans la partie LAN, puis l'onglet Baux statiques. Cliquer sur Ajouter un bail statique.</p>
<p><img loading="lazy" decoding="async" src="/notes/pi-hole-box-sfr/wZmwSd_EYx-320.webp" alt="Les baux statiques sur la box SFR" width="640" height="290" srcset="/notes/pi-hole-box-sfr/wZmwSd_EYx-320.webp 320w, /notes/pi-hole-box-sfr/wZmwSd_EYx-640.webp 640w" sizes="(max-width: 640px) 320px, 640px"></p>
<p>Ensuite, il suffit de sélectionner l'équipement et lui attribuer une IP quelconque (192.168.1.30 dans mon cas).</p>
<p><img loading="lazy" decoding="async" src="/notes/pi-hole-box-sfr/33vR1jXdx8-320.webp" alt="Ajouter un bail statique sur la box SFR" width="640" height="420" srcset="/notes/pi-hole-box-sfr/33vR1jXdx8-320.webp 320w, /notes/pi-hole-box-sfr/33vR1jXdx8-640.webp 640w" sizes="(max-width: 640px) 320px, 640px"></p>
<h2 id="installer-pi-hole" tabindex="-1">Installer Pi-Hole <a class="title-anchor" href="#installer-pi-hole" aria-hidden="true">#</a></h2>
<p>Le Raspberry Pi est maintenant prêt à être configuré. Pour se connecter en SSH, il suffit de lancer la commande suivante</p>
<pre class="language-bash"><code class="language-bash"><span class="token operator">></span> <span class="token function">ssh</span> pi@192.168.1.30</code></pre>
<p><code>pi</code> est l'utilisateur par défaut et <code>192.168.1.30</code> l'IP précédemment attribuée. Dans ce cas, le mot de passe par défaut est <code>raspberry</code>, mais il peut être défini lors du processus d'installation de l'OS (voir plus haut).</p>
<p>On peut ensuite lancer la commande d’installation de Pi-Hole:</p>
<pre class="language-bash"><code class="language-bash"><span class="token operator">></span> <span class="token function">curl</span> <span class="token parameter variable">-sSL</span> https://install.pi-hole.net <span class="token operator">|</span> <span class="token function">bash</span></code></pre>
<p>La configuration propose plusieurs choix de fournisseurs de DNS. Il faut donc bien lire <a href="https://docs.pi-hole.net/guides/dns/upstream-dns-providers/">la documentation</a> avant de choisir. De mon côté, j’ai choisi OpenDNS pour son filtre anti-phising et le filtre familial.</p>
<p>Une fois l'installation terminée, l’interface de Pi-Hole est accessible à http://192.168.1.30/admin/index.php.</p>
<h2 id="configuration-finale" tabindex="-1">Configuration finale <a class="title-anchor" href="#configuration-finale" aria-hidden="true">#</a></h2>
<p>Pi-Hole fonctionne, il faut maintenant le définir comme DNS primaire. Pour cela, dans la partie LAN de l'interface de la box, on peut entrer l'IP du Raspberry comme DNS primaire.</p>
<p><img loading="lazy" decoding="async" src="/notes/pi-hole-box-sfr/M-SwI3iRUs-320.webp" alt="Changer les DNS primaires" width="640" height="434" srcset="/notes/pi-hole-box-sfr/M-SwI3iRUs-320.webp 320w, /notes/pi-hole-box-sfr/M-SwI3iRUs-640.webp 640w" sizes="(max-width: 640px) 320px, 640px"></p>
<p>Toutes les requêtes transiteront désormais vers le Raspberry Pi, qui pourra filtrer selon ses règles.</p>
<h2 id="autorisation-sur-macos" tabindex="-1">Autorisation sur MacOS <a class="title-anchor" href="#autorisation-sur-macos" aria-hidden="true">#</a></h2>
<p>Sur MacOS version 15 (Sequoia), il faut veiller à ce que le navigateur ait les droits pour accéder au réseau local, sans quoi il sera impossble d'accéder au dashboard de Pi-Hole. Pour cela, il faut autoriser l'accès en se rendant dans Réglages système / Confidentialité et sécurité / Réseau local.</p>
<p><img loading="lazy" decoding="async" src="/notes/pi-hole-box-sfr/NqLHgm3Xdz-320.webp" alt="autoriser l'accès au réseau local sur MacOS" width="640" height="361" srcset="/notes/pi-hole-box-sfr/NqLHgm3Xdz-320.webp 320w, /notes/pi-hole-box-sfr/NqLHgm3Xdz-640.webp 640w" sizes="(max-width: 640px) 320px, 640px"></p>
<h2 id="desactiver-pour-certains-appareils" tabindex="-1">Desactiver pour certains appareils <a class="title-anchor" href="#desactiver-pour-certains-appareils" aria-hidden="true">#</a></h2>
<p>Avec le temps, j'ai noté que le décodeur TV SFR ne fonctionnait pas très bien lorsque Pi-Hole était activé en tant que DNS. En particulier, les services annexes (replay, VOD, etc.) semblaient toujours bloqués. La solution est de laisser passer toutes les requêtes qui émanent de cet appareil pour ne pas entraver son fonctionnement. Pour cela, il faut tout d'abord créer un groupe, que l'on appelera Bypass (ou n'importe quoi d'autre).</p>
<p>Ensuite, on assigne l'appareil voulu à ce groupe dans Client &gt; Add a new client. On recherche son adresse IP, et on l'assigne à ce groupe, et uniquement celui-ci.</p>
<p>Enfin, on va éviter le filtrage pour ce groupe en se rendant dans Adlists. Sur chaque liste sélectionnée (une seule dans mon cas), on ôte le groupe Bypass.</p>
<p>Il m'a également fallu rajouter Google dans les serveurs DNS.</p>
<p><img loading="lazy" decoding="async" src="/notes/pi-hole-box-sfr/gyumnYV3zG-320.webp" alt="Désactive le filtrage pour un groupe" width="640" height="248" srcset="/notes/pi-hole-box-sfr/gyumnYV3zG-320.webp 320w, /notes/pi-hole-box-sfr/gyumnYV3zG-640.webp 640w" sizes="(max-width: 640px) 320px, 640px"></p>
<h2 id="bonus" tabindex="-1">Bonus <a class="title-anchor" href="#bonus" aria-hidden="true">#</a></h2>
<p>Il est également possible d’ajouter une URL locale qui permettra d’accéder à l’interface d’admin de Pi-Hole via l’url pi.hole/admin/. Tous les utilisateurs du réseau local y auront accès.</p>
<p><img loading="lazy" decoding="async" src="/notes/pi-hole-box-sfr/JIw3py3cXk-320.webp" alt="Ajouter une DNS locale" width="640" height="264" srcset="/notes/pi-hole-box-sfr/JIw3py3cXk-320.webp 320w, /notes/pi-hole-box-sfr/JIw3py3cXk-640.webp 640w" sizes="(max-width: 640px) 320px, 640px"></p>

      </div>

      
      <p class="article__update">
        Mis à jour le 
          <time datetime="2024-11-17">17/11/2024</time>
      </p>
      

    </div>
  </section>
</article>

    </main>
    
    <footer class="page-footer" role="contentinfo">
  <div class="container">
    <div class="page-footer__menus">
      <ul class="page-footer__menu">
        <li>
          <a href="/mentions-legales/">Mentions légales</a>
        </li>
        <li>
          <a href="/plan-site/">Plan du site</a>
        </li>
        <li>
          <a href="/blogroll/">Blogroll</a>
        </li>
        <li>
          <a href="/notes/rss.xml">RSS</a>
        </li>
      </ul>
      <div>
        <p>Dernière mise à jour le 09/01/2025</p>
        <ul class="page-footer__social">
          <li>
            <a rel="me" href="https://github.com/jeanremy" title="Lien vers le profil GitHub">
              <svg width="21" height="20" viewBox="0 0 21 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                <title>Voir le profil GitHub</title>
                <path d="M10.7359 0.256348C5.06489 0.256348 0.47168 4.60731 0.47168 9.97375C0.47168 14.268 3.41236 17.9096 7.4898 19.1931C8.00298 19.2845 8.19118 18.9842 8.19118 18.7259C8.19118 18.4951 8.18258 17.8837 8.17838 17.0739C5.3232 17.6602 4.72104 15.7701 4.72104 15.7701C4.25402 14.6486 3.57915 14.349 3.57915 14.349C2.64939 13.7465 3.651 13.7587 3.651 13.7587C4.68169 13.8267 5.22313 14.7596 5.22313 14.7596C6.13835 16.2455 7.6258 15.8163 8.21258 15.5677C8.30498 14.9393 8.56928 14.511 8.86268 14.268C6.58313 14.0251 4.1873 13.1894 4.1873 9.46602C4.1873 8.40521 4.58504 7.53867 5.24366 6.8585C5.12819 6.61313 4.78177 5.6252 5.33347 4.28663C5.33347 4.28663 6.19309 4.02588 8.15608 5.28266C8.97728 5.06645 9.84968 4.95956 10.7222 4.9547C11.5946 4.95956 12.4671 5.06645 13.2882 5.28266C15.2384 4.02588 16.098 4.28663 16.098 4.28663C16.6497 5.6252 16.3033 6.61313 16.2007 6.8585C16.855 7.53867 17.2527 8.40521 17.2527 9.46602C17.2527 13.1991 14.8535 14.021 12.5697 14.2599C12.929 14.5514 13.2626 15.1474 13.2626 16.0576C13.2626 17.3581 13.2497 18.4028 13.2497 18.7186C13.2497 18.9736 13.4293 19.2773 13.9554 19.1801C18.0619 17.9055 21 14.2615 21 9.97375C21 4.60731 16.4042 0.256348 10.7359 0.256348Z" fill="white"></path>
              </svg>

            </a>
          </li>
          <li>
            <a rel="me" href="https://mastodon.design/@jnrmprd" title="Lien vers le profil mastodon">
              <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                <title>Voir le profil Mastodon</title>
                <path d="M18.6167 11.6171C18.3367 12.952 16.1767 14.4194 13.6467 14.7034C12.3367 14.8454 11.0467 14.9874 9.67673 14.9306C7.42673 14.8265 5.67668 14.4194 5.67668 14.4194V15.0064C5.99668 17.1081 7.89673 17.2312 9.70673 17.2975C11.5267 17.3448 13.1467 16.862 13.1467 16.862L13.2267 18.4241C13.2267 18.4241 11.9467 19.0678 9.67673 19.1909C8.42673 19.2572 6.86673 19.1625 5.05668 18.7175C1.13668 17.7235 0.45668 13.7567 0.35668 9.72362L0.34668 6.47636C0.34668 2.36755 3.17668 1.16521 3.17668 1.16521C4.62668 0.540366 7.08673 0.256348 9.64673 0.256348H9.70673C12.2667 0.256348 14.7267 0.540366 16.1767 1.16521C16.1767 1.16521 19.0067 2.36755 19.0067 6.47636C19.0067 6.47636 19.0467 9.51534 18.6167 11.6171ZM15.6767 6.79825C15.6767 5.77578 15.3767 4.98999 14.8267 4.37462C14.2667 3.77818 13.5267 3.46576 12.5967 3.46576C11.5367 3.46576 10.7267 3.85392 10.1767 4.63024L9.67673 5.46336L9.17673 4.63024C8.61673 3.85392 7.81673 3.46576 6.74673 3.46576C5.82668 3.46576 5.08668 3.77818 4.51668 4.37462C3.96668 4.98999 3.67668 5.77578 3.67668 6.79825V11.778H5.77668V6.94026C5.77668 5.93672 6.22668 5.40655 7.13673 5.40655C8.13673 5.40655 8.63673 6.02193 8.63673 7.23372V9.8751H10.7067V7.23372C10.7067 6.02193 11.2067 5.40655 12.2167 5.40655C13.1167 5.40655 13.5667 5.93672 13.5667 6.94026V11.778H15.6767V6.79825Z" fill="white"></path>
              </svg>

            </a>
          </li>
        </ul>
      </div>

    </div>

  </div>
</footer>


  </body>
</html>
