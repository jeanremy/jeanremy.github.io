<!DOCTYPE html>
<html lang="fr-FR">
  <head>
    <meta charset="utf-8">
    
      <title>Optimiser ses fontes avec Glyphhanger - Jean-Rémy Praud</title>
    
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="description" content="Developpeur fullstack, j’aime travailler sur des projets porteurs de sens. Je m’intéresse tout particulièrement à l’éco-conception et à l’accessibilité.">
    <meta name="robots" content="noodp">

    
<link rel="icon" href="/favicon.ico">
<link rel="icon" type="image/svg+xml" href="/favicon.svg">
<link rel="apple-touch-icon" href="/apple-touch-icon.png">
    

    <meta property="og:title" content="Optimiser ses fontes avec Glyphhanger">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://jeanremypraud.com/notes/optimiser-fonts-glyphhanger/">
    <meta property="og:site_name" content="Jean-Rémy Praud">
    <meta property="og:description" content="Comment réduire la taille d&#39;une fonte en ne gardant que les glyphes utiles grâce à Glyphhanger">
    <meta property="og:image" content="/assets/og-images/4755e566.png">

    <link rel="stylesheet" href="/assets/css/base.css">
    
    <script type="application/ld+json">
	{
		"@context": "https://schema.org",
		"@graph": [
			{
				"@type": "WebSite",
				"@id": "https://jeanremypraud.com#website",
				"url": "https://jeanremypraud.com",
				"name": "Jean-Rémy Praud",
				"description": "Developpeur fullstack, j’aime travailler sur des projets porteurs de sens. Je m’intéresse tout particulièrement à l’éco-conception et à l’accessibilité.",
				"inLanguage": "fr_FR"
			}
		]
	}
</script>

  </head>
  <body class="page">
    
    <a href="#main" class="sr-only sr-only-focusable">Accéder au contenu</a>

    <header class="page-header" role="banner">
  <div class="container">
    <p class="page__title">
      <a href="/" rel="me" title="jr retour à l'accueil">jr<span>.</span></a>
    </p>
    <nav class="page-header__menu" role="navigation" aria-label="Navigation principale">
      <ul>
        <li>
          <a href="/notes/" aria-current="page">Notes</a>
        </li>
        <li>
          <a href="/a-propos/">À propos</a>
        </li>
      </ul>
      
    </nav>
  </div>
</header>


    <main class="main" role="main" id="main" tabindex="-1">
      <article class="article">
  <header class="article__header">
    <div class="container">
      
        


  <nav class="breadcrumb" role="navigation" aria-label="Fil d'ariane">
    
      
        <a href="/">Accueil</a> >
      
    
      
        <a href="/notes/">Notes</a> >
      
    
      
        Optimiser ses fontes avec Glyphhanger
      
    
  </nav>


      

      <h1 class="article__title">
        Optimiser ses fontes avec Glyphhanger
      </h1>
    </div>
  </header>
  <section class="article__content">
    <div class="container">
      
        <p class="article__date">
        Posté le
          <time datetime="2025-04-24">24/04/2025</time>
        </p>
      
      
      <div class="md blog_content">
        <p>Lorsque l'on utilise une police custom sur le web, il est rare que la totalité des glyphes soit utilisée.</p>
<p>Dans une optique d'efficience, il peut être intéressant de vouloir supprimer ces signes typographiques inutiles. Et c'est là que la <a href="https://github.com/zachleat/glyphhanger">librairie Glyphhanger</a> entre en jeu.</p>
<p><img src="/notes/optimiser-fonts-glyphhanger/TF3tZW0Xdp-320.webp" alt="Une partie de la liste des glyphes utilisés dans la police Albert Sans. Chaque carré représente un glyphe." loading="lazy" decoding="async" width="640" height="326" srcset="/notes/optimiser-fonts-glyphhanger/TF3tZW0Xdp-320.webp 320w, /notes/optimiser-fonts-glyphhanger/TF3tZW0Xdp-640.webp 640w" sizes="(max-width: 640px) 320px, 640px"></p>
<p>Glyphhanger permet de réduire le poids d'une police, mais permet aussi de définir un sous-ensemble (subset) de caractères que l'on souhaite garder dans un fichier séparé.</p>
<p>Avant toute chose, il faut s'assurer que supprimer des glyphes est autorisé par la licence de distribution de la police. Une liste (partielle) de fontes l'autorisant est disponible sur le site <a href="https://subsetting.xyz/">subsetting.xyz</a>. A noter que les Google Fonts le permettent via la licence <a href="https://en.wikipedia.org/wiki/SIL_Open_Font_License">SIL Open Font License</a>.</p>
<h2 id="reduire-la-poids" tabindex="-1">Réduire la poids <a class="title-anchor" href="#reduire-la-poids" aria-hidden="true">#</a></h2>
<p>Il est possible de simplement réduire le poids de sa fonte en une seule ligne de commande.</p>
<pre class="language-bash"><code class="language-bash">glyphhanger <span class="token parameter variable">--subset</span><span class="token operator">=</span>AlbertSans.ttf<br><br>Subsetting AlbertSans.ttf to AlbertSans-subset.ttf <span class="token punctuation">(</span>was <span class="token number">125.41</span> KB, now <span class="token number">122.57</span> KB<span class="token punctuation">)</span><br>Subsetting AlbertSans.ttf to AlbertSans-subset.zopfli.woff <span class="token punctuation">(</span>was <span class="token number">125.41</span> KB, now <span class="token number">59</span> KB<span class="token punctuation">)</span><br>Subsetting AlbertSans.ttf to AlbertSans-subset.woff2 <span class="token punctuation">(</span>was <span class="token number">125.41</span> KB, now <span class="token number">49.78</span> KB<span class="token punctuation">)</span></code></pre>
<p><strong>Quel format utiliser ?</strong></p>
<p>J'utilise le format woff2 qui supporte les fontes variables et dont <a href="https://caniuse.com/?search=woff">le support est très élevé</a>: 97.15%. Il est conseillé d'ajouter woff en fallback.</p>
<p>La police a été réduite de 53% en woff et jusqu'à 61% au format woff2. Elle contient néanmoins de nombreux glyphes qui ne seront pas utilisés, laissant une place à l'optimisation.</p>
<h2 id="definir-un-subset" tabindex="-1">Définir un subset <a class="title-anchor" href="#definir-un-subset" aria-hidden="true">#</a></h2>
<p>Pour choisir le sous-ensemble (subset) de caractères que l'on souhaite conserver, plusieurs options s'offre à nous.</p>
<h3>Passer une liste de caractères en <em>whitelist</em></h3>
<p>Si la liste de glyphes est relativement courte (dans le cas d'une fonte d'icônes complète par exemple), il est relativement aisé de passer directement les caractères que l'on souhaite conserver.</p>
<pre class="language-bash"><code class="language-bash">glyphhanger <span class="token parameter variable">--subset</span><span class="token operator">=</span>AlbertSans.ttf <span class="token parameter variable">--whitelist</span><span class="token operator">=</span>abcdefgh</code></pre>
<p>L'application <a href="https://character-table.netlify.app/">Character table</a> permet d'obtenir la liste des glyphes à retenir par langue. Il suffit de copier la liste et la passer en whitelist.</p>
<h3>Passer un subset prédéfini</h3>
<p>Glyphhanger prédéfini des subsets, comme LATIN et --US_ASCII.</p>
<pre class="language-bash"><code class="language-bash">glyphhanger <span class="token parameter variable">--LATIN</span> <span class="token parameter variable">--subset</span><span class="token operator">=</span>AlbertSans.ttf</code></pre>
<p>Ces deux options sont intéressantes, car l'on garde qu'une liste définie de caractères. Toutefois, il est possible d'oublier certaines caractères utilisés dans les pages.</p>
<h3>Passer une URL</h3>
<p>Il est possible de passer à l'outil une URL d'où il tirera tous les glyphes nécéssaires. Il peut parcourir plusieurs pages grâce à l'option <code>--spider</code> ou <code>--spider-limit</code>.</p>
<pre class="language-bash"><code class="language-bash">glyphhanger http://localhost:8080/notes --spider-limit<span class="token operator">=</span><span class="token number">0</span> <span class="token parameter variable">--subset</span><span class="token operator">=</span>AlbertSans.ttf <span class="token parameter variable">--formats</span><span class="token operator">=</span>woff2</code></pre>
<p>L'intérêt de cette méthode est de créer un subset qui contient tous les glyphes des pages.</p>
<p>Mais que se passe-t-il si un utilisateur traduit le contenu (via Google translate par exemple), et que des glyphes non prévus doivent être affichés ?</p>
<h2 id="organiser-les-subsets" tabindex="-1">Organiser les subsets <a class="title-anchor" href="#organiser-les-subsets" aria-hidden="true">#</a></h2>
<p>Il existe une propriété CSS qui permet d'associer une fonte à une liste de caractères: <code>unicode-range</code>. On peut donc définir un subset avec tous les glyphes utilisés (via <code>spider</code>) ou présents dans une langue et un autre subset avec tous les caractères manquants, puis associer les fichiers générés avec le bon interval unicode.</p>
<p>Quelques précisions sur la propriété <code>font-face</code>:</p>
<ul>
<li>Il est possible de déclarer plusieurs fichiers pour une même fonte. Les navigateurs se chargent ensuite de merger les déclarations, comme <a href="https://jakearchibald.com/2017/combining-fonts/">le présente Jake Archibald</a>.</li>
<li>Si un ou des caractères sont présents dans plusieurs déclarations via unicode-range, c'est la dernière qui sera effective.</li>
</ul>
<p>En résumé, on peut donc créer les subsets par langue (ici en français), puis par interval unicode:</p>
<pre class="language-bash"><code class="language-bash">glyphhanger <span class="token parameter variable">--subset</span><span class="token operator">=</span>AlbertSans.ttf <span class="token parameter variable">--output</span><span class="token operator">=</span>custom <span class="token parameter variable">--formats</span><span class="token operator">=</span>woff2,woff <span class="token parameter variable">--whitelist</span><span class="token operator">=</span>U+0000-00A0,U+00A2-00A9,U+00AC-00AE,U+00B0-00B7,U+00B9-00BA,U+00BC-00BE,U+00D7,U+00F7,U+2000-206F,U+2074,U+20AC,U+2122,U+2190-21BB,U+2212,U+2215,U+F8FF,U+FEFF,U+FFFD,U+00A1,U+00AA-00AB,U+00AF,U+00B8,U+00BB,U+00BF-00D6,U+00D8-00F6,U+00F8-00FF,U+0131,U+0152-0153,U+02B0-02FF<br><br>glyphhanger <span class="token parameter variable">--subset</span><span class="token operator">=</span>AlbertSans.ttf <span class="token parameter variable">--formats</span><span class="token operator">=</span>woff2,woff<br><br></code></pre>
<pre class="language-css"><code class="language-css"><span class="token comment">/* la police générique qui contient tous les signes */</span><br><span class="token atrule"><span class="token rule">@font-face</span></span> <span class="token punctuation">{</span><br>  <span class="token property">font-family</span><span class="token punctuation">:</span> <span class="token string">"Albert Sans"</span><span class="token punctuation">;</span><br>  <span class="token property">src</span><span class="token punctuation">:</span> <span class="token url"><span class="token function">url</span><span class="token punctuation">(</span><span class="token string url">"../fonts/AlbertSans.woff2"</span><span class="token punctuation">)</span></span> <span class="token function">format</span><span class="token punctuation">(</span><span class="token string">"woff2"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token url"><span class="token function">url</span><span class="token punctuation">(</span><span class="token string url">"../fonts/AlbertSans.woff"</span><span class="token punctuation">)</span></span><br>      <span class="token function">format</span><span class="token punctuation">(</span><span class="token string">"woff"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><span class="token punctuation">}</span><br><br><span class="token comment">/* La police du subset, déclarée en dernière, qui sera donc préférée par les navigateurs lorsqu'ils rencontreront les glyphes présents */</span><br><span class="token atrule"><span class="token rule">@font-face</span></span> <span class="token punctuation">{</span><br>  <span class="token property">font-family</span><span class="token punctuation">:</span> <span class="token string">"Albert Sans"</span><span class="token punctuation">;</span><br>  <span class="token property">src</span><span class="token punctuation">:</span> <span class="token url"><span class="token function">url</span><span class="token punctuation">(</span><span class="token string url">"../fonts/custom/AlbertSans.woff2"</span><span class="token punctuation">)</span></span> <span class="token function">format</span><span class="token punctuation">(</span><span class="token string">"woff2"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token url"><span class="token function">url</span><span class="token punctuation">(</span><span class="token string url">"../fonts/custom/AlbertSans.woff"</span><span class="token punctuation">)</span></span><br>      <span class="token function">format</span><span class="token punctuation">(</span><span class="token string">"woff"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>  <span class="token comment">/* French unicode range fetched from https://character-table.netlify.app/french/ */</span><br>  <span class="token property">unicode-range</span><span class="token punctuation">:</span> U+20-5F<span class="token punctuation">,</span> U+61-7A<span class="token punctuation">,</span> U+7C<span class="token punctuation">,</span> U+A0<span class="token punctuation">,</span> U+A7<span class="token punctuation">,</span> U+A9<span class="token punctuation">,</span> U+AB<span class="token punctuation">,</span> U+B2-B3<span class="token punctuation">,</span> U+BB<span class="token punctuation">,</span><br>    U+C0<span class="token punctuation">,</span> U+C2<span class="token punctuation">,</span> U+C6-CB<span class="token punctuation">,</span> U+CE-CF<span class="token punctuation">,</span> U+D4<span class="token punctuation">,</span> U+D9<span class="token punctuation">,</span> U+DB-DC<span class="token punctuation">,</span> U+E0<span class="token punctuation">,</span> U+E2<span class="token punctuation">,</span> U+E6-EB<span class="token punctuation">,</span><br>    U+EE-EF<span class="token punctuation">,</span> U+F4<span class="token punctuation">,</span> U+F9<span class="token punctuation">,</span> U+FB-FC<span class="token punctuation">,</span> U+FF<span class="token punctuation">,</span> U+152-153<span class="token punctuation">,</span> U+178<span class="token punctuation">,</span> U+2B3<span class="token punctuation">,</span> U+2E2<span class="token punctuation">,</span><br>    U+1D48-1D49<span class="token punctuation">,</span> U+2010-2011<span class="token punctuation">,</span> U+2013-2014<span class="token punctuation">,</span> U+2019<span class="token punctuation">,</span> U+201C-201D<span class="token punctuation">,</span> U+2020-2021<span class="token punctuation">,</span><br>    U+2026<span class="token punctuation">,</span> U+202F-2030<span class="token punctuation">,</span> U+20AC<span class="token punctuation">,</span> U+2212<span class="token punctuation">;</span><br><span class="token punctuation">}</span></code></pre>
<p>Attention à l'unité de mesure <code>ch</code>. Firefox charge indifférement les deux polices si l'unité ch est utilisée quelque part dans le CSS. Un <a href="https://webcompat.com/issues/153900">ticket</a> est ouvert à ce sujet.</p>
<h2 id="credits" tabindex="-1">Crédits <a class="title-anchor" href="#credits" aria-hidden="true">#</a></h2>
<p>Pour rédiger ce billet, je me suis beaucoup aidé du blog de <a href="https://markoskon.com/creating-font-subsets/">Markos Konstantopoulos</a>, de la <a href="https://github.com/zachleat/glyphhanger">documentation de Glyphhanger</a> ainsi que de <a href="https://mastodon.design/@carbontwelve@notacult.social/109882845407952893">cet échange Mastodon qui m'a mis sur la piste du unicode-range</a>.</p>

      </div>

      

    </div>
  </section>
</article>

    </main>
    
    <footer class="page-footer" role="contentinfo">
  <div class="container">
    <div class="page-footer__menus">
      <ul class="page-footer__menu">
        <li>
          <a href="/mentions-legales/">Mentions légales</a>
        </li>
        <li>
          <a href="/plan-site/">Plan du site</a>
        </li>
        <li>
          <a href="/blogroll/">Blogroll</a>
        </li>
        <li>
          <a href="/notes/rss.xml">RSS</a>
        </li>
      </ul>
      <div>
        <p>Dernière mise à jour le 24/04/2025</p>
        <ul class="page-footer__social">
          <li>
            <a rel="me" href="https://github.com/jeanremy" title="Lien vers le profil GitHub">
              <svg width="21" height="20" viewBox="0 0 21 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                <title>Voir le profil GitHub</title>
                <path d="M10.7359 0.256348C5.06489 0.256348 0.47168 4.60731 0.47168 9.97375C0.47168 14.268 3.41236 17.9096 7.4898 19.1931C8.00298 19.2845 8.19118 18.9842 8.19118 18.7259C8.19118 18.4951 8.18258 17.8837 8.17838 17.0739C5.3232 17.6602 4.72104 15.7701 4.72104 15.7701C4.25402 14.6486 3.57915 14.349 3.57915 14.349C2.64939 13.7465 3.651 13.7587 3.651 13.7587C4.68169 13.8267 5.22313 14.7596 5.22313 14.7596C6.13835 16.2455 7.6258 15.8163 8.21258 15.5677C8.30498 14.9393 8.56928 14.511 8.86268 14.268C6.58313 14.0251 4.1873 13.1894 4.1873 9.46602C4.1873 8.40521 4.58504 7.53867 5.24366 6.8585C5.12819 6.61313 4.78177 5.6252 5.33347 4.28663C5.33347 4.28663 6.19309 4.02588 8.15608 5.28266C8.97728 5.06645 9.84968 4.95956 10.7222 4.9547C11.5946 4.95956 12.4671 5.06645 13.2882 5.28266C15.2384 4.02588 16.098 4.28663 16.098 4.28663C16.6497 5.6252 16.3033 6.61313 16.2007 6.8585C16.855 7.53867 17.2527 8.40521 17.2527 9.46602C17.2527 13.1991 14.8535 14.021 12.5697 14.2599C12.929 14.5514 13.2626 15.1474 13.2626 16.0576C13.2626 17.3581 13.2497 18.4028 13.2497 18.7186C13.2497 18.9736 13.4293 19.2773 13.9554 19.1801C18.0619 17.9055 21 14.2615 21 9.97375C21 4.60731 16.4042 0.256348 10.7359 0.256348Z" fill="white"></path>
              </svg>

            </a>
          </li>
          <li>
            <a rel="me" href="https://mastodon.design/@jnrmprd" title="Lien vers le profil mastodon">
              <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                <title>Voir le profil Mastodon</title>
                <path d="M18.6167 11.6171C18.3367 12.952 16.1767 14.4194 13.6467 14.7034C12.3367 14.8454 11.0467 14.9874 9.67673 14.9306C7.42673 14.8265 5.67668 14.4194 5.67668 14.4194V15.0064C5.99668 17.1081 7.89673 17.2312 9.70673 17.2975C11.5267 17.3448 13.1467 16.862 13.1467 16.862L13.2267 18.4241C13.2267 18.4241 11.9467 19.0678 9.67673 19.1909C8.42673 19.2572 6.86673 19.1625 5.05668 18.7175C1.13668 17.7235 0.45668 13.7567 0.35668 9.72362L0.34668 6.47636C0.34668 2.36755 3.17668 1.16521 3.17668 1.16521C4.62668 0.540366 7.08673 0.256348 9.64673 0.256348H9.70673C12.2667 0.256348 14.7267 0.540366 16.1767 1.16521C16.1767 1.16521 19.0067 2.36755 19.0067 6.47636C19.0067 6.47636 19.0467 9.51534 18.6167 11.6171ZM15.6767 6.79825C15.6767 5.77578 15.3767 4.98999 14.8267 4.37462C14.2667 3.77818 13.5267 3.46576 12.5967 3.46576C11.5367 3.46576 10.7267 3.85392 10.1767 4.63024L9.67673 5.46336L9.17673 4.63024C8.61673 3.85392 7.81673 3.46576 6.74673 3.46576C5.82668 3.46576 5.08668 3.77818 4.51668 4.37462C3.96668 4.98999 3.67668 5.77578 3.67668 6.79825V11.778H5.77668V6.94026C5.77668 5.93672 6.22668 5.40655 7.13673 5.40655C8.13673 5.40655 8.63673 6.02193 8.63673 7.23372V9.8751H10.7067V7.23372C10.7067 6.02193 11.2067 5.40655 12.2167 5.40655C13.1167 5.40655 13.5667 5.93672 13.5667 6.94026V11.778H15.6767V6.79825Z" fill="white"></path>
              </svg>

            </a>
          </li>
        </ul>
      </div>

    </div>

  </div>
</footer>


  </body>
</html>
